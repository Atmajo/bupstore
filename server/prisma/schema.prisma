generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                String    @id @default(uuid())
  firstName         String?
  lastName          String?
  email             String    @unique
  password          String
  isEmailVerified   Boolean   @default(false)
  emailVerifyToken  String?   @unique
  emailVerifyExpiry DateTime?
  resetToken        String?   @unique
  userJWT           String?   @unique
  resetTokenExpiry  DateTime?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  backups           Domain[]
}

model Domain {
  id             String   @id @default(uuid())
  userId         String
  name           String   @unique
  codes          Code[]
  remainingCodes Int      @default(0)
  totalCodes     Int      @default(0)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Code {
  id        String    @id @default(uuid())
  code      String
  slot      Int
  status    String
  usedAt    DateTime?
  domainId  String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  domain    Domain?   @relation(fields: [domainId], references: [id], onDelete: Cascade)
}
